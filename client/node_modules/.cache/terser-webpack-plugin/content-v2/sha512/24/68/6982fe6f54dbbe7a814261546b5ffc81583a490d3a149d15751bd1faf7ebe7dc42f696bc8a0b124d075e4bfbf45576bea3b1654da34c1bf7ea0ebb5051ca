{"map":{"version":3,"sources":["static/js/main.d6ec1cd1.chunk.js"],"names":["this","push","104","module","exports","111","__webpack_require__","112","__webpack_exports__","r","SocketEvent","react","react_default","n","react_dom","react_dom_default","react_router","styles","font-size","padding","components_Button","_ref","name","onClick","a","createElement","style","slicedToArray","axios","axios_default","getTimeWithMinutesOffset","minutes","Date","getTime","SPOTIFY_URL","APP_URL","APP_API","ROOT","REFRESH_TOKEN","LOGIN","SPOTIFY_API","SPOTIFY_ACCOUNT_URL","ME","CURRENTLY_PLAYING","PLAYER","PLAY","PAUSE","lib","src_socket","lib_default","UserContext","Object","user","undefined","isLoading","logout","UserContext_UserProvider","storedUser","storedAccessToken","storedRefreshToken","children","_useState","_useState2","setUser","_useState3","_useState4","setIsLoading","localStorage","getItem","window","location","hash","console","log","login","parsedUser","JSON","parse","expiryDate","parseInt","getNewAccessToken","then","res","updateUser","setAuthheader","data","access_token","setItem","toString","locationArgs","hashInput","substring","params","split","map","hk","temp","getHashParams","get","stringify","refresh_token","emit","USER_LOGGEDIN_REQ","id","clear","refreshToken","accessToken","defaults","headers","common","SettingsContext","Provider","value","UserContext_useUser","pages_Home","history","_useUser","on","CREATE_PARTY_RES","newPartyId","display_name","CREATE_PARTY_REQ","href","className","imageStyle","height","Party_Player","playback","item","album","artists","src","images","url","is_playing","Party_UserAvatar","_ref2","isAdmin","length","substr","pages_Party","_ref3","_currentParty$users","pollCurrentlyPlaying","match","currentParty","setCurrentParty","partyId","currentPartyRef","useRef","current","handleUserLeaving","USER_LEFT_PARTY_RES","onUserLeftParty","PARTY_PLAYBACK_CHANGED_RES","onPlaybackChanged","PARTY_NOT_FOUND_RES","onPartyNotFound","PARTY_NEW_USER_JOINED_RES","onNewUserJoined","PARTY_JOINED_RES","onPartyJoined","PARTY_CHANGED_ADMIN_RES","onAdminChanged","PARTY_JOINED_REQ","socketId","party","_party$adminUser","adminUser","playbackState","_currentPartyRef$curr","_currentPartyRef$curr2","_currentPartyRef$curr3","_currentPartyRef$curr4","_currentPartyRef$curr5","_currentPartyRef$curr6","isNowPlaying","isNowPaused","isNewSong","playSong","pauseSong","_party$users","users","setTimeout","_currentPartyRef$curr7","_currentPartyRef$curr8","_party$adminUser2","wasPreviouslyAdmin","clearInterval","getCurrentlyPlaying","setInterval","off","USER_LEFT_PARTY_REQ","userId","isFirstTime","arguments","args","uris","uri","position_ms","progress_ms","put","catch","err","error","response","reason","PARTY_PLAYBACK_REQ","_currentParty$adminUs","key","src_App","exact","path","component","Boolean","hostname","react_router_dom","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","message","25","53","58"],"mappings":"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"},"code":"(this[\"webpackJsonplistening-party\"]=this[\"webpackJsonplistening-party\"]||[]).push([[0],{104:function(e,t){},111:function(e,t,a){},112:function(e,t,a){\"use strict\";a.r(t);var n,o=a(0),l=a.n(o),i=a(49),r=a.n(i),c=(a(58),a(25),a(4));!function(e){e.USER_LOGGEDIN_REQ=\"USER_LOGGEDIN_REQ\",e.USER_DISCONNECTED_REQ=\"USER_DISCONNECTED_REQ\",e.CREATE_PARTY_REQ=\"CREATE_PARTY_REQ\",e.CREATE_PARTY_RES=\"CREATE_PARTY_RES\",e.USER_JOINED_RES=\"USER_JOINED_RES\",e.USER_JOINED_REQ=\"USER_JOINED_REQ\",e.USER_LEFT_PARTY_REQ=\"USER_LEFT_PARTY_REQ\",e.USER_LEFT_PARTY_RES=\"USER_LEFT_PARTY_RES\",e.PARTY_JOINED_REQ=\"PARTY_JOINED_REQ\",e.PARTY_JOINED_UNAUTHED_REQ=\"PARTY_JOINED_UNAUTHED_REQ\",e.PARTY_JOINED_UNAUTHED_RES=\"PARTY_JOINED_UNAUTHED_RES\",e.PARTY_JOINED_RES=\"PARTY_JOINED_RES\",e.PARTY_NOT_FOUND_RES=\"PARTY_NOT_FOUND_RES\",e.PARTY_PLAYBACK_CHANGED_RES=\"PARTY_PLAYBACK_CHANGED_RES\",e.PARTY_PLAYBACK_REQ=\"PARTY_PLAYBACK_REQ\",e.PARTY_NEW_USER_JOINED_RES=\"PARTY_NEW_USER_JOINED_RES\",e.PARTY_CHANGED_ADMIN_RES=\"PARTY_CHANGED_ADMIN_RES\"}(n||(n={}));var s={\"font-size\":\"20px\",padding:\"10px 20px\"},u=function(e){var t=e.name,a=e.onClick;return l.a.createElement(\"button\",{style:s,onClick:a},t)},E=a(9),_=a(5),d=a.n(_),m=function(e){return new Date((new Date).getTime()+60*e*1e3)},R=\"https://api.spotify.com/v1\",p=\"http://localhost:8080\",g={ROOT:p,REFRESH_TOKEN:p+\"/refresh_token\",LOGIN:p+\"/login\"},f={LOGIN:\"https://accounts.spotify.com/authorize\",ME:R+\"/me\",CURRENTLY_PLAYING:R+\"/me/player/currently-playing\",PLAYER:R+\"/me/player\",PLAY:R+\"/me/player/play\",PAUSE:R+\"/me/player/pause\"},v=a(50),A=a.n(v)()(g.ROOT),S=Object(o.createContext)({user:void 0,isLoading:!1,logout:function(){}}),N=function(e){var t,a,i,r=e.children,c=Object(o.useState)(),s=Object(E.a)(c,2),u=s[0],_=s[1],R=Object(o.useState)(!0),p=Object(E.a)(R,2),v=p[0],N=p[1];Object(o.useEffect)((function(){if(t=localStorage.getItem(\"user\"),a=localStorage.getItem(\"access_token\"),i=localStorage.getItem(\"refresh_token\"),!t||!a||!i){if(!window.location.hash)return;return console.log(\"loggin in ...\"),void T()}var e=JSON.parse(t),n=localStorage.getItem(\"expiry_time\");n&&(new Date).getTime()>parseInt(n)?(console.log(\"expired\"),h(i).then((function(t){y(e),O(t.data.access_token),localStorage.setItem(\"access_token\",t.data.access_token),localStorage.setItem(\"expiry_time\",m(59).getTime().toString())}))):(O(a),y(e))}),[]);var T=function(){var e=function(e){var t=e.substring(1),a={};return t.split(\"&\").map((function(e){var t=e.split(\"=\");a[t[0]]=t[1]})),a}(window.location.hash);O(e.access_token),d.a.get(f.ME).then((function(t){y(t.data),localStorage.setItem(\"user\",JSON.stringify(t.data)),localStorage.setItem(\"access_token\",e.access_token),localStorage.setItem(\"refresh_token\",e.refresh_token),localStorage.setItem(\"expiry_time\",m(1).getTime().toString())}))},y=function(e){_(e),N(!1),A.emit(n.USER_LOGGEDIN_REQ,e.id)},P=function(){_(void 0),localStorage.clear()},h=function(e){return d.a.get(g.REFRESH_TOKEN,{params:{refresh_token:e}})},O=function(e){d.a.defaults.headers.common.Authorization=\"Bearer \"+e},Y=Object(o.useMemo)((function(){return{user:u,isLoading:v,logout:P}}),[u,P]);return l.a.createElement(S.Provider,{value:Y},r)},T=function(){return Object(o.useContext)(S)},y=function(){var e=Object(c.f)(),t=T(),a=t.user,i=t.logout;Object(o.useEffect)((function(){A.on(n.CREATE_PARTY_RES,(function(t){e.push(\"/party/\"+t)}))}),[]);return l.a.createElement(\"div\",null,a&&a.id?l.a.createElement(\"div\",null,l.a.createElement(\"h1\",null,\"Hi, \",a.display_name,\"!\"),l.a.createElement(u,{name:\"Start a party \\ud83c\\udf89\",onClick:function(){A.emit(n.CREATE_PARTY_REQ,A.id)}}),l.a.createElement(\"a\",{href:\"\",className:\"d-block\",onClick:i},\"Logout\")):l.a.createElement(\"a\",{href:g.LOGIN},\"Login\"))},P=(a(111),{height:\"300px\"}),h=function(e){var t=e.playback;return l.a.createElement(\"div\",null,l.a.createElement(\"h3\",{className:\"song\"},null===t||void 0===t?void 0:t.item.name,\" by \",null===t||void 0===t?void 0:t.item.album.artists[0].name),l.a.createElement(\"img\",{style:P,src:t.item.album.images[0].url}),l.a.createElement(\"h3\",null,t.is_playing?\"Playing\":\"Paused\"))},O=function(e){var t=e.user,a=e.isAdmin;return l.a.createElement(\"span\",{className:\"avatar\"},t.images.length>0?l.a.createElement(\"img\",{className:\"avatar__img\",src:t.images[0].url}):l.a.createElement(\"span\",{className:\"avatar__placeholder\"},l.a.createElement(\"span\",{className:\"avatar__placeholder__letter\"},t.display_name.substr(0,1))),l.a.createElement(\"span\",{className:\"avatar__name\"},t.display_name,\" \",a?\"(DJ)\":\"\"))},Y=function(e){var t,a,i=e.match,r=T(),s=r.user,u=r.isLoading,_=Object(o.useState)(void 0),m=Object(E.a)(_,2),R=m[0],p=m[1],g=i.params.id,v=Object(c.f)(),S=l.a.useRef(R);Object(o.useEffect)((function(){S.current=R}),[R]),Object(o.useEffect)((function(){return function(){return b()}}),[]);Object(o.useEffect)((function(){s&&!u?(console.log(\"Logged in as \",s.display_name),A.on(n.USER_LEFT_PARTY_RES,N),A.on(n.PARTY_PLAYBACK_CHANGED_RES,y),A.on(n.PARTY_NOT_FOUND_RES,Y),A.on(n.PARTY_NEW_USER_JOINED_RES,P),A.on(n.PARTY_JOINED_RES,I),A.on(n.PARTY_CHANGED_ADMIN_RES,D),A.emit(n.PARTY_JOINED_REQ,{user:s,socketId:A.id,partyId:g})):u||console.log(\"You are not authed\")}),[s]);var N=function(e){console.log(\"A user left party.\"),p(e)},y=function(e){var t;if(console.log(\"Playback state updated.\"),!((null===(t=e.adminUser)||void 0===t?void 0:t.id)===(null===s||void 0===s?void 0:s.id))&&e.playbackState){var a,n,o,l,i,r,c=e.playbackState.is_playing&&!(null===(a=S.current)||void 0===a||null===(n=a.playbackState)||void 0===n?void 0:n.is_playing),u=!e.playbackState.is_playing&&(null===(o=S.current)||void 0===o||null===(l=o.playbackState)||void 0===l?void 0:l.is_playing),E=(null===(i=S.current)||void 0===i||null===(r=i.playbackState)||void 0===r?void 0:r.item.id)!==e.playbackState.item.id;c||E?k(e.playbackState,!0):u&&U()}p(e)},P=function(e){var t;console.log(\"New user joined,\",e.users?e.users[(null===(t=e.users)||void 0===t?void 0:t.length)-1].display_name:\"\"),p(e)},Y=function(){console.log(\"This party was not found... redirecting back\"),setTimeout((function(){v.push(\"/\")}),2e3)},I=function(e){p(e),e.playbackState&&e.playbackState.is_playing&&k(e.playbackState,!0)},D=function(e){var t,n,o,l=(null===(t=S.current)||void 0===t||null===(n=t.adminUser)||void 0===n?void 0:n.id)===(null===s||void 0===s?void 0:s.id);(null===(o=e.adminUser)||void 0===o?void 0:o.id)!==(null===s||void 0===s?void 0:s.id)||l||(console.log(\"Youve been assigned admin.\"),clearInterval(a),C(e.id),a=setInterval((function(){C(e.id)}),1e4)),p(e)},b=function(){A.off(n.USER_LEFT_PARTY_RES,N),A.off(n.PARTY_PLAYBACK_CHANGED_RES,y),A.off(n.PARTY_NOT_FOUND_RES,Y),A.off(n.PARTY_NEW_USER_JOINED_RES,P),A.off(n.PARTY_JOINED_RES,I),A.off(n.PARTY_CHANGED_ADMIN_RES,D),console.log(\"Leaving party.\"),clearInterval(a),A.emit(n.USER_LEFT_PARTY_REQ,{userId:null===s||void 0===s?void 0:s.id,partyId:g})},k=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];console.log(\"setting currently playing...\");var a={uris:[e.item.uri],position_ms:t?e.progress_ms:0};d.a.put(f.PLAY,a).then((function(){return console.log(\"Playing new song: \",e.item.name)})).catch((function(e){var t=e.response.data.error;\"NO_ACTIVE_DEVICE\"===t.reason?console.log(\"Could not play song. No active device found.\"):\"PREMIUM_REQUIRED\"===t.reason?console.log(\"Could not play song. Premium required.\"):console.log(\"Could not play song. Error: \",t)}))},U=function(){d.a.put(f.PAUSE).then((function(){return console.log(\"Paused song.\")})).catch((function(e){var t=e.response.data.error;console.log(\"Could not pause song: \",t)}))},C=function(e){console.log(\"Getting currently playing...\"),d.a.get(f.CURRENTLY_PLAYING).then((function(t){t.data&&t.data.item?A.emit(n.PARTY_PLAYBACK_REQ,{playbackState:t.data,partyId:e}):console.log(\"Nothing is playing, its an ad, or you are in private mode.\")})).catch((function(e){console.log(\"could not get currently playing\")}))};return l.a.createElement(\"div\",{className:\"party-wrap\"},s&&s.id?l.a.createElement(\"div\",null,l.a.createElement(\"h2\",{className:\"mb-2\"},\"Welcome to the party \",s.display_name,\" \\ud83c\\udf89\"),(null===R||void 0===R?void 0:R.playbackState)?l.a.createElement(h,{playback:R.playbackState}):l.a.createElement(\"div\",null,\"No tracks playing\"),l.a.createElement(\"div\",{className:\"user-wrap\"},l.a.createElement(\"h2\",null,\"People in the party are\"),l.a.createElement(\"div\",{className:\"users\"},null===R||void 0===R||null===(t=R.users)||void 0===t?void 0:t.map((function(e){var t;return l.a.createElement(O,{key:e.id,isAdmin:e.id===(null===(t=R.adminUser)||void 0===t?void 0:t.id),user:e})}))))):l.a.createElement(\"div\",null,\"This is a party, but you aint authed.\"))};var I=function(){return l.a.createElement(N,null,l.a.createElement(\"div\",{className:\"App\"},l.a.createElement(c.c,null,l.a.createElement(c.a,{exact:!0,path:\"/\"},l.a.createElement(y,null)),l.a.createElement(c.a,{path:\"/party/:id\",component:Y}))))};Boolean(\"localhost\"===window.location.hostname||\"[::1]\"===window.location.hostname||window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var D=a(15);r.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(D.a,null,l.a.createElement(I,null))),document.getElementById(\"root\")),\"serviceWorker\"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},25:function(e,t,a){},53:function(e,t,a){e.exports=a(112)},58:function(e,t,a){}},[[53,1,2]]]);","extractedComments":[]}