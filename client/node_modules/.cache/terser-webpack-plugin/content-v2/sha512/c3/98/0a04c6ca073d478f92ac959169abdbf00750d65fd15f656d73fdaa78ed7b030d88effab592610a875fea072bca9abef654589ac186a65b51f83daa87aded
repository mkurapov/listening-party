{"map":{"version":3,"sources":["static/js/main.ef0db1b7.chunk.js"],"names":["this","push","104","module","exports","111","__webpack_exports__","__webpack_require__","r","SocketEvent","react","react_default","n","react_dom","react_dom_default","react_router","components_Button","_ref","name","onClick","a","createElement","slicedToArray","axios","axios_default","getTimeWithMinutesOffset","minutes","Date","getTime","SPOTIFY_URL","APP_URL","APP_API","ROOT","REFRESH_TOKEN","LOGIN","SPOTIFY_API","SPOTIFY_ACCOUNT_URL","ME","CURRENTLY_PLAYING","PLAYER","PLAY","lib","src_socket","lib_default","UserContext","Object","user","undefined","isLoading","logout","UserContext_UserProvider","storedUser","storedAccessToken","storedRefreshToken","children","_useState","_useState2","setUser","_useState3","_useState4","setIsLoading","localStorage","getItem","expiryDate","parseInt","console","log","getNewAccessToken","then","res","updateUser","setAuthheader","data","access_token","setItem","toString","window","location","hash","login","locationArgs","hashInput","substring","params","split","map","hk","temp","getHashParams","get","JSON","stringify","refresh_token","emit","USER_CONNECTED_REQ","id","clear","refreshToken","accessToken","defaults","headers","common","SettingsContext","Provider","value","UserContext_useUser","pages_Home","history","_useUser","on","CREATE_PARTY_RES","newPartyId","CREATE_PARTY_REQ","href","imageStyle","width","height","Party","_currentParty$adminUs","_currentParty$users","_currentParty$playbac","_currentParty$playbac2","pollCurrentlyPlaying","match","currentParty","setCurrentParty","partyId","handleUserLeaving","display_name","USER_LEFT_PARTY_RES","onUserLeftParty","PARTY_PLAYBACK_CHANGED_RES","onPlaybackChanged","PARTY_NOT_FOUND_RES","onPartyNotFound","PARTY_NEW_USER_JOINED_RES","onNewUserJoined","PARTY_JOINED_RES","onPartyJoined","PARTY_CHANGED_ADMIN_RES","onAdminChanged","PARTY_JOINED_REQ","socketId","party","_party$adminUser","adminUser","playbackState","setCurrentlyPlaying","_party$users","users","length","setTimeout","is_playing","_party$adminUser2","clearInterval","setInterval","getCurrentlyPlaying","off","USER_LEFT_PARTY_REQ","args","uris","item","uri","put","catch","err","error","response","reason","PARTY_PLAYBACK_REQ","join","className","album","artists","style","src","images","url","src_App","exact","path","component","Boolean","hostname","react_router_dom","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","message","52","57","58"],"mappings":"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"},"code":"(this[\"webpackJsonplistening-party\"]=this[\"webpackJsonplistening-party\"]||[]).push([[0],{104:function(e,t){},111:function(e,t,n){\"use strict\";n.r(t);var a,o=n(0),l=n.n(o),i=n(48),r=n.n(i),c=(n(57),n(58),n(4));!function(e){e.USER_CONNECTED_REQ=\"USER_CONNECTED_REQ\",e.USER_DISCONNECTED_REQ=\"USER_DISCONNECTED_REQ\",e.CREATE_PARTY_REQ=\"CREATE_PARTY_REQ\",e.CREATE_PARTY_RES=\"CREATE_PARTY_RES\",e.USER_JOINED_RES=\"USER_JOINED_RES\",e.USER_JOINED_REQ=\"USER_JOINED_REQ\",e.USER_LEFT_PARTY_REQ=\"USER_LEFT_PARTY_REQ\",e.USER_LEFT_PARTY_RES=\"USER_LEFT_PARTY_RES\",e.PARTY_JOINED_REQ=\"PARTY_JOINED_REQ\",e.PARTY_JOINED_UNAUTHED_REQ=\"PARTY_JOINED_UNAUTHED_REQ\",e.PARTY_JOINED_UNAUTHED_RES=\"PARTY_JOINED_UNAUTHED_RES\",e.PARTY_JOINED_RES=\"PARTY_JOINED_RES\",e.PARTY_NOT_FOUND_RES=\"PARTY_NOT_FOUND_RES\",e.PARTY_PLAYBACK_CHANGED_RES=\"PARTY_PLAYBACK_CHANGED_RES\",e.PARTY_PLAYBACK_REQ=\"PARTY_PLAYBACK_REQ\",e.PARTY_NEW_USER_JOINED_RES=\"PARTY_NEW_USER_JOINED_RES\",e.PARTY_CHANGED_ADMIN_RES=\"PARTY_CHANGED_ADMIN_RES\"}(a||(a={}));var E=function(e){var t=e.name,n=e.onClick;return l.a.createElement(\"button\",{onClick:n},t)},u=n(9),s=n(5),_=n.n(s),R=function(e){return new Date((new Date).getTime()+60*e*1e3)},d=\"https://api.spotify.com/v1\",m=\"http://localhost:8080\",g={ROOT:m,REFRESH_TOKEN:m+\"/refresh_token\",LOGIN:m+\"/login\"},A={LOGIN:\"https://accounts.spotify.com/authorize\",ME:d+\"/me\",CURRENTLY_PLAYING:d+\"/me/player/currently-playing\",PLAYER:d+\"/me/player\",PLAY:d+\"/me/player/play\"},f=n(49),T=n.n(f)()(g.ROOT),S=Object(o.createContext)({user:void 0,isLoading:!1,logout:function(){}}),p=function(e){var t,n,i,r=e.children,c=Object(o.useState)(),E=Object(u.a)(c,2),s=E[0],d=E[1],m=Object(o.useState)(!0),f=Object(u.a)(m,2),p=f[0],v=f[1];Object(o.useEffect)((function(){if(t=localStorage.getItem(\"user\"),n=localStorage.getItem(\"access_token\"),i=localStorage.getItem(\"refresh_token\"),t&&n&&i){var e=localStorage.getItem(\"expiry_time\");e&&(new Date).getTime()>parseInt(e)?(console.log(\"expired\"),Y(i).then((function(e){y(t),O(e.data.access_token),localStorage.setItem(\"access_token\",e.data.access_token),localStorage.setItem(\"expiry_time\",R(1).getTime().toString())}))):(console.log(\"not expired\"),y(t))}else{if(!window.location.hash)return;N()}}),[]);var N=function(){var e=function(e){var t=e.substring(1),n={};return t.split(\"&\").map((function(e){var t=e.split(\"=\");n[t[0]]=t[1]})),n}(window.location.hash);O(e.access_token),_.a.get(A.ME).then((function(t){var n=t.data;y(n),localStorage.setItem(\"user\",JSON.stringify(n)),localStorage.setItem(\"access_token\",e.access_token),localStorage.setItem(\"refresh_token\",e.refresh_token),localStorage.setItem(\"expiry_time\",R(1).getTime().toString())}))},y=function(e){console.log(\"updating user to \",e),d(e),v(!1),T.emit(a.USER_CONNECTED_REQ,e.id)},P=function(){d(void 0),localStorage.clear()},Y=function(e){return _.a.get(g.REFRESH_TOKEN,{params:{refresh_token:e}})},O=function(e){_.a.defaults.headers.common.Authorization=\"Bearer \"+e},h=Object(o.useMemo)((function(){return{user:s,isLoading:p,logout:P}}),[s,P]);return l.a.createElement(S.Provider,{value:h},r)},v=function(){return Object(o.useContext)(S)},N=function(){var e=Object(c.f)(),t=v(),n=t.user,i=t.logout;Object(o.useEffect)((function(){T.on(a.CREATE_PARTY_RES,(function(t){e.push(\"/party/\"+t)}))}),[]);return l.a.createElement(\"div\",null,n&&n.id?l.a.createElement(\"div\",null,l.a.createElement(\"div\",null,\"Hi, \",n.id,\"!\"),l.a.createElement(E,{name:\"Logout\",onClick:i}),l.a.createElement(E,{name:\"Create new Room\",onClick:function(){T.emit(a.CREATE_PARTY_REQ,T.id)}})):l.a.createElement(\"a\",{href:g.LOGIN},\"Login\"))},y={width:\"100vw\",height:\"auto\"},P=function(e){var t,n,i,r,E,s=e.match,R=v(),d=R.user,m=R.isLoading,g=Object(o.useState)(void 0),f=Object(u.a)(g,2),S=f[0],p=f[1],N=s.params.id,P=Object(c.f)();Object(o.useEffect)((function(){return function(){return U()}}),[]),Object(o.useEffect)((function(){d&&!m?(console.log(\"Logged in as \",d.display_name),T.on(a.USER_LEFT_PARTY_RES,Y),T.on(a.PARTY_PLAYBACK_CHANGED_RES,O),T.on(a.PARTY_NOT_FOUND_RES,D),T.on(a.PARTY_NEW_USER_JOINED_RES,h),T.on(a.PARTY_JOINED_RES,I),T.on(a.PARTY_CHANGED_ADMIN_RES,C),T.emit(a.PARTY_JOINED_REQ,{user:d,socketId:T.id,partyId:N})):m||console.log(\"You are not authed\")}),[d]);var Y=function(e){console.log(\"A user left party.\"),p(e)},O=function(e){var t;console.log(\"Playback state changed.\"),(null===(t=e.adminUser)||void 0===t?void 0:t.id)===(null===d||void 0===d?void 0:d.id)||e.playbackState&&b(e.playbackState),p(e)},h=function(e){var t;console.log(\"New user joined,\",e.users?e.users[(null===(t=e.users)||void 0===t?void 0:t.length)-1].display_name:\"\"),p(e)},D=function(){console.log(\"This party was not found... redirecting back\"),setTimeout((function(){P.push(\"/\")}),2e3)},I=function(e){p(e),e.playbackState&&e.playbackState.is_playing&&b(e.playbackState)},C=function(e){var t;clearInterval(E),(null===(t=e.adminUser)||void 0===t?void 0:t.id)===(null===d||void 0===d?void 0:d.id)&&(console.log(\"Youve been assigned admin.\"),E=setInterval((function(){k(e.id)}),5e3)),p(e)},U=function(){T.off(a.USER_LEFT_PARTY_RES,Y),T.off(a.PARTY_PLAYBACK_CHANGED_RES,O),T.off(a.PARTY_NOT_FOUND_RES,D),T.off(a.PARTY_NEW_USER_JOINED_RES,h),T.off(a.PARTY_JOINED_RES,I),T.off(a.PARTY_CHANGED_ADMIN_RES,C),console.log(\"Leaving party.\"),clearInterval(E),T.emit(a.USER_LEFT_PARTY_REQ)},b=function(e){console.log(\"setting currently playing...\",e);var t={uris:[e.item.uri]};_.a.put(A.PLAY,t).then((function(){return console.log(\"Playing new song: \",e.item.name)})).catch((function(e){var t=e.response.data.error;\"NO_ACTIVE_DEVICE\"===t.reason?console.log(\"Could not play song. No active device found.\"):\"PREMIUM_REQUIRED\"===t.reason?console.log(\"Could not play song. Premium required.\"):console.log(\"Could not play song. Error: \",t)}))},k=function(e){console.log(\"Getting currently playing...\"),_.a.get(A.CURRENTLY_PLAYING).then((function(t){t.data&&t.data.item?T.emit(a.PARTY_PLAYBACK_REQ,{playbackState:t.data,partyId:e}):console.log(\"Nothing is playing, its an ad, or you are in private mode.\")})).catch((function(e){console.log(\"could not get currently playing\")}))};return l.a.createElement(\"div\",null,d&&d.id?l.a.createElement(\"div\",null,l.a.createElement(\"h1\",null,\"A duper dope party\"),l.a.createElement(\"h2\",null,\"Hi, \",d.display_name,\"!\"),l.a.createElement(\"div\",null,\"The DJ is \",null===S||void 0===S||null===(t=S.adminUser)||void 0===t?void 0:t.display_name),l.a.createElement(\"div\",null,\"Users in party: \",null===S||void 0===S||null===(n=S.users)||void 0===n?void 0:n.map((function(e){return e.display_name})).join(\", \")),(null===S||void 0===S?void 0:S.playbackState)?l.a.createElement(\"div\",null,l.a.createElement(\"div\",{className:\"song\"},\"Currently playing\"),l.a.createElement(\"h3\",null,null===S||void 0===S||null===(i=S.playbackState)||void 0===i?void 0:i.item.name),l.a.createElement(\"h3\",null,null===S||void 0===S||null===(r=S.playbackState)||void 0===r?void 0:r.item.album.artists[0].name),l.a.createElement(\"img\",{style:y,src:S.playbackState.item.album.images[0].url})):l.a.createElement(\"div\",null,\"No tracks playing\")):l.a.createElement(\"div\",null,\"This is a party, but you aint authed.\"))};var Y=function(){return l.a.createElement(p,null,l.a.createElement(\"div\",{className:\"App\"},l.a.createElement(\"header\",{className:\"App-header\"}),l.a.createElement(c.c,null,l.a.createElement(c.a,{exact:!0,path:\"/\"},l.a.createElement(N,null)),l.a.createElement(c.a,{path:\"/party/:id\",component:P}))))};Boolean(\"localhost\"===window.location.hostname||\"[::1]\"===window.location.hostname||window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var O=n(15);r.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(O.a,null,l.a.createElement(Y,null))),document.getElementById(\"root\")),\"serviceWorker\"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},52:function(e,t,n){e.exports=n(111)},57:function(e,t,n){},58:function(e,t,n){}},[[52,1,2]]]);","extractedComments":[]}