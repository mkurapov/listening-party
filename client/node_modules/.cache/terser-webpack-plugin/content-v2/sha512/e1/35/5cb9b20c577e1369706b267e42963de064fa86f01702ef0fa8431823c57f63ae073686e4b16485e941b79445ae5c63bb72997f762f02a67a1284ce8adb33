{"map":{"version":3,"sources":["static/js/main.f1b9faa0.chunk.js"],"names":["this","push","104","module","exports","111","__webpack_exports__","__webpack_require__","r","SocketEvent","react","react_default","n","react_dom","react_dom_default","react_router","components_Button","_ref","name","onClick","a","createElement","slicedToArray","axios","axios_default","SPOTIFY_URL","SPOTIFY_API","LOGIN","SPOTIFY_ACCOUNT_URL","ME","CURRENTLY_PLAYING","PLAYER","PLAY","lib","src_socket","lib_default","UserContext","Object","user","undefined","isLoading","logout","UserContext_UserProvider","children","_useState","_useState2","setUser","_useState3","_useState4","setIsLoading","savedUser","localStorage","getItem","savedAccessToken","savedRefreshToken","expiryDate","console","log","Date","getTime","parseInt","setAuthheader","_user","JSON","parse","emit","USER_CONNECTED_REQ","id","window","location","hash","login","locationArgs","hashInput","substring","params","split","map","hk","temp","getHashParams","access_token","get","then","res","minutes","data","setItem","stringify","refresh_token","toString","clear","accessToken","defaults","headers","common","SettingsContext","Provider","value","UserContext_useUser","pages_Home","history","_useUser","on","CREATE_PARTY_RES","newPartyId","CREATE_PARTY_REQ","href","APP_URL","imageStyle","width","height","Party","_currentParty$adminUs","_currentParty$users","_currentParty$playbac","_currentParty$playbac2","pollCurrentlyPlaying","match","currentParty","setCurrentParty","partyId","handleUserLeaving","display_name","USER_LEFT_PARTY_RES","onUserLeftParty","PARTY_PLAYBACK_CHANGED_RES","onPlaybackChanged","PARTY_NOT_FOUND_RES","onPartyNotFound","PARTY_NEW_USER_JOINED_RES","onNewUserJoined","PARTY_JOINED_RES","onPartyJoined","PARTY_CHANGED_ADMIN_RES","onAdminChanged","PARTY_JOINED_REQ","socketId","party","_party$adminUser","adminUser","playbackState","setCurrentlyPlaying","_party$users","users","length","setTimeout","is_playing","_party$adminUser2","clearInterval","setInterval","getCurrentlyPlaying","off","USER_LEFT_PARTY_REQ","args","uris","item","uri","put","catch","err","error","response","reason","PARTY_PLAYBACK_REQ","join","className","album","artists","style","src","images","url","src_App","exact","path","component","Boolean","hostname","react_router_dom","render","StrictMode","document","getElementById","navigator","serviceWorker","ready","registration","unregister","message","52","57","58"],"mappings":"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"},"code":"(this[\"webpackJsonplistening-party\"]=this[\"webpackJsonplistening-party\"]||[]).push([[0],{104:function(e,t){},111:function(e,t,n){\"use strict\";n.r(t);var a,o=n(0),l=n.n(o),i=n(48),r=n.n(i),c=(n(57),n(58),n(4));!function(e){e.USER_CONNECTED_REQ=\"USER_CONNECTED_REQ\",e.USER_DISCONNECTED_REQ=\"USER_DISCONNECTED_REQ\",e.CREATE_PARTY_REQ=\"CREATE_PARTY_REQ\",e.CREATE_PARTY_RES=\"CREATE_PARTY_RES\",e.USER_JOINED_RES=\"USER_JOINED_RES\",e.USER_JOINED_REQ=\"USER_JOINED_REQ\",e.USER_LEFT_PARTY_REQ=\"USER_LEFT_PARTY_REQ\",e.USER_LEFT_PARTY_RES=\"USER_LEFT_PARTY_RES\",e.PARTY_JOINED_REQ=\"PARTY_JOINED_REQ\",e.PARTY_JOINED_UNAUTHED_REQ=\"PARTY_JOINED_UNAUTHED_REQ\",e.PARTY_JOINED_UNAUTHED_RES=\"PARTY_JOINED_UNAUTHED_RES\",e.PARTY_JOINED_RES=\"PARTY_JOINED_RES\",e.PARTY_NOT_FOUND_RES=\"PARTY_NOT_FOUND_RES\",e.PARTY_PLAYBACK_CHANGED_RES=\"PARTY_PLAYBACK_CHANGED_RES\",e.PARTY_PLAYBACK_REQ=\"PARTY_PLAYBACK_REQ\",e.PARTY_NEW_USER_JOINED_RES=\"PARTY_NEW_USER_JOINED_RES\",e.PARTY_CHANGED_ADMIN_RES=\"PARTY_CHANGED_ADMIN_RES\"}(a||(a={}));var E=function(e){var t=e.name,n=e.onClick;return l.a.createElement(\"button\",{onClick:n},t)},u=n(9),_=n(7),s=n.n(_),R=\"https://api.spotify.com/v1\",d={LOGIN:\"https://accounts.spotify.com/authorize\",ME:R+\"/me\",CURRENTLY_PLAYING:R+\"/me/player/currently-playing\",PLAYER:R+\"/me/player\",PLAY:R+\"/me/player/play\"},m=n(49),A=n.n(m)()(\"http://localhost:8080\"),g=Object(o.createContext)({user:void 0,isLoading:!1,logout:function(){}}),f=function(e){var t=e.children,n=Object(o.useState)(),i=Object(u.a)(n,2),r=i[0],c=i[1],E=Object(o.useState)(!0),_=Object(u.a)(E,2),R=_[0],m=_[1];Object(o.useEffect)((function(){var e=localStorage.getItem(\"user\"),t=localStorage.getItem(\"access_token\"),n=localStorage.getItem(\"refresh_token\");if(e&&t&&n){var o=localStorage.getItem(\"expiry_time\");if(console.log(o),console.log((new Date).getTime()),o&&(new Date).getTime()>parseInt(o)&&console.log(\"expired\"),e){S(t);var l=JSON.parse(e);c(l),m(!1),A.emit(a.USER_CONNECTED_REQ,l.id)}}else{if(!window.location.hash)return;f()}}),[]);var f=function(){var e=function(e){var t=e.substring(1),n={};return t.split(\"&\").map((function(e){var t=e.split(\"=\");n[t[0]]=t[1]})),n}(window.location.hash);S(e.access_token),s.a.get(d.ME).then((function(t){var n,o=t.data;console.log(o),c(o),m(!1),A.emit(a.USER_CONNECTED_REQ,o.id),localStorage.setItem(\"user\",JSON.stringify(o)),localStorage.setItem(\"access_token\",e.access_token),localStorage.setItem(\"refresh_token\",e.refresh_token),localStorage.setItem(\"expiry\",(n=59,new Date((new Date).getTime()+60*n*1e3)).getTime().toString())}))},T=function(){c(void 0),localStorage.clear()},S=function(e){s.a.defaults.headers.common.Authorization=\"Bearer \"+e},p=Object(o.useMemo)((function(){return{user:r,isLoading:R,logout:T}}),[r,T]);return l.a.createElement(g.Provider,{value:p},t)},T=function(){return Object(o.useContext)(g)},S=function(){var e=Object(c.f)(),t=T(),n=t.user,i=t.logout;Object(o.useEffect)((function(){A.on(a.CREATE_PARTY_RES,(function(t){e.push(\"/party/\"+t)}))}),[]);return l.a.createElement(\"div\",null,n&&n.id?l.a.createElement(\"div\",null,l.a.createElement(\"div\",null,\"Hi, \",n.id,\"!\"),l.a.createElement(E,{name:\"Logout\",onClick:i}),l.a.createElement(E,{name:\"Create new Room\",onClick:function(){A.emit(a.CREATE_PARTY_REQ,A.id)}})):l.a.createElement(\"a\",{href:\"http://localhost:8080/login\"},\"Login\"))},p={width:\"100vw\",height:\"auto\"},v=function(e){var t,n,i,r,E,_=e.match,R=T(),m=R.user,g=R.isLoading,f=Object(o.useState)(void 0),S=Object(u.a)(f,2),v=S[0],N=S[1],P=_.params.id,y=Object(c.f)();Object(o.useEffect)((function(){return function(){return U()}}),[]),Object(o.useEffect)((function(){m&&!g?(console.log(\"Logged in as \",m.display_name),A.on(a.USER_LEFT_PARTY_RES,Y),A.on(a.PARTY_PLAYBACK_CHANGED_RES,h),A.on(a.PARTY_NOT_FOUND_RES,O),A.on(a.PARTY_NEW_USER_JOINED_RES,D),A.on(a.PARTY_JOINED_RES,C),A.on(a.PARTY_CHANGED_ADMIN_RES,I),A.emit(a.PARTY_JOINED_REQ,{user:m,socketId:A.id,partyId:P})):g||console.log(\"You are not authed\")}),[m]);var Y=function(e){console.log(\"A user left party.\"),N(e)},h=function(e){var t;console.log(\"Playback state changed.\"),(null===(t=e.adminUser)||void 0===t?void 0:t.id)===(null===m||void 0===m?void 0:m.id)||e.playbackState&&b(e.playbackState),N(e)},D=function(e){var t;console.log(\"New user joined,\",e.users?e.users[(null===(t=e.users)||void 0===t?void 0:t.length)-1].display_name:\"\"),N(e)},O=function(){console.log(\"This party was not found... redirecting back\"),setTimeout((function(){y.push(\"/\")}),2e3)},C=function(e){N(e),e.playbackState&&e.playbackState.is_playing&&b(e.playbackState)},I=function(e){var t;clearInterval(E),(null===(t=e.adminUser)||void 0===t?void 0:t.id)===(null===m||void 0===m?void 0:m.id)&&(console.log(\"Youve been assigned admin.\"),E=setInterval((function(){k(e.id)}),5e3)),N(e)},U=function(){A.off(a.USER_LEFT_PARTY_RES,Y),A.off(a.PARTY_PLAYBACK_CHANGED_RES,h),A.off(a.PARTY_NOT_FOUND_RES,O),A.off(a.PARTY_NEW_USER_JOINED_RES,D),A.off(a.PARTY_JOINED_RES,C),A.off(a.PARTY_CHANGED_ADMIN_RES,I),console.log(\"Leaving party.\"),clearInterval(E),A.emit(a.USER_LEFT_PARTY_REQ)},b=function(e){console.log(\"setting currently playing...\",e);var t={uris:[e.item.uri]};s.a.put(d.PLAY,t).then((function(){return console.log(\"Playing new song: \",e.item.name)})).catch((function(e){var t=e.response.data.error;\"NO_ACTIVE_DEVICE\"===t.reason?console.log(\"Could not play song. No active device found.\"):\"PREMIUM_REQUIRED\"===t.reason?console.log(\"Could not play song. Premium required.\"):console.log(\"Could not play song. Error: \",t)}))},k=function(e){console.log(\"Getting currently playing...\"),s.a.get(d.CURRENTLY_PLAYING).then((function(t){t.data&&t.data.item?A.emit(a.PARTY_PLAYBACK_REQ,{playbackState:t.data,partyId:e}):console.log(\"Nothing is playing, its an ad, or you are in private mode.\")})).catch((function(e){console.log(\"could not get currently playing\")}))};return l.a.createElement(\"div\",null,m&&m.id?l.a.createElement(\"div\",null,l.a.createElement(\"h1\",null,\"A duper dope party\"),l.a.createElement(\"h2\",null,\"Hi, \",m.display_name,\"!\"),l.a.createElement(\"div\",null,\"The DJ is \",null===v||void 0===v||null===(t=v.adminUser)||void 0===t?void 0:t.display_name),l.a.createElement(\"div\",null,\"Users in party: \",null===v||void 0===v||null===(n=v.users)||void 0===n?void 0:n.map((function(e){return e.display_name})).join(\", \")),(null===v||void 0===v?void 0:v.playbackState)?l.a.createElement(\"div\",null,l.a.createElement(\"div\",{className:\"song\"},\"Currently playing\"),l.a.createElement(\"h3\",null,null===v||void 0===v||null===(i=v.playbackState)||void 0===i?void 0:i.item.name),l.a.createElement(\"h3\",null,null===v||void 0===v||null===(r=v.playbackState)||void 0===r?void 0:r.item.album.artists[0].name),l.a.createElement(\"img\",{style:p,src:v.playbackState.item.album.images[0].url})):l.a.createElement(\"div\",null,\"No tracks playing\")):l.a.createElement(\"div\",null,\"This is a party, but you aint authed.\"))};var N=function(){return l.a.createElement(f,null,l.a.createElement(\"div\",{className:\"App\"},l.a.createElement(\"header\",{className:\"App-header\"}),l.a.createElement(c.c,null,l.a.createElement(c.a,{exact:!0,path:\"/\"},l.a.createElement(S,null)),l.a.createElement(c.a,{path:\"/party/:id\",component:v}))))};Boolean(\"localhost\"===window.location.hostname||\"[::1]\"===window.location.hostname||window.location.hostname.match(/^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var P=n(15);r.a.render(l.a.createElement(l.a.StrictMode,null,l.a.createElement(P.a,null,l.a.createElement(N,null))),document.getElementById(\"root\")),\"serviceWorker\"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},52:function(e,t,n){e.exports=n(111)},57:function(e,t,n){},58:function(e,t,n){}},[[52,1,2]]]);","extractedComments":[]}