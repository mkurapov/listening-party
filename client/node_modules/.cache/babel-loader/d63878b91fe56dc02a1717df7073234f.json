{"ast":null,"code":"import React,{useEffect}from'react';import'./App.css';import io from'socket.io-client';import API_ENDPOINTS from'./endpoints';import axios from'axios';import{Switch,Route}from'react-router-dom';import Button from'./components/Button';import{getHashParams}from'./helpers/helpers';import{UserProvider,useUser}from'./contexts/UserContext';function App(){var APP_URL='http://localhost:8080';var LOGIN_URL=APP_URL+'/login';var _useUser=useUser(),user=_useUser.user,updateUser=_useUser.updateUser,clearUser=_useUser.clearUser;console.log(user);var socket=io(APP_URL);socket.on('party-created',function(party){console.log(party);});var checkLogIn=function checkLogIn(){var savedUser=localStorage.getItem('user');if(savedUser){updateUser(JSON.parse(savedUser));return;}if(!window.location.hash)return;login();};useEffect(checkLogIn,[]);var logout=function logout(){clearUser();localStorage.clear();};var login=function login(){var locationArgs=getHashParams(window.location.hash);axios.defaults.headers.common['Authorization']='Bearer '+locationArgs.access_token;axios.get(API_ENDPOINTS.ME).then(function(res){console.log(res.data);var user=res.data;updateUser(user);localStorage.setItem('user',JSON.stringify(user));// socket.emit('newconnection', user);\n});};var createRoom=function createRoom(){socket.emit('party-create',socket.id);};return/*#__PURE__*/React.createElement(UserProvider,null,/*#__PURE__*/React.createElement(\"div\",{className:\"App\"},/*#__PURE__*/React.createElement(\"header\",{className:\"App-header\"}),/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/\"},user&&user.id?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",null,\"Hi, \",user.id,\"!\"),/*#__PURE__*/React.createElement(Button,{name:\"Logout\",onClick:logout}),/*#__PURE__*/React.createElement(Button,{name:\"Create new Room\",onClick:createRoom})):/*#__PURE__*/React.createElement(\"a\",{href:LOGIN_URL},\"Login\")))));}export default App;","map":{"version":3,"sources":["/Users/max/dev/listening-party/client/src/App.tsx"],"names":["React","useEffect","io","API_ENDPOINTS","axios","Switch","Route","Button","getHashParams","UserProvider","useUser","App","APP_URL","LOGIN_URL","user","updateUser","clearUser","console","log","socket","on","party","checkLogIn","savedUser","localStorage","getItem","JSON","parse","window","location","hash","login","logout","clear","locationArgs","defaults","headers","common","access_token","get","ME","then","res","data","setItem","stringify","createRoom","emit","id"],"mappings":"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","sourcesContent":["import React, { createContext, useEffect, useState } from 'react';\nimport './App.css';\nimport io from 'socket.io-client'\nimport API_ENDPOINTS from './endpoints'\n\nimport axios, { AxiosResponse } from 'axios';\n\nimport { Switch, Route, useHistory } from 'react-router-dom';\nimport Home from './pages/authenticated/Party';\nimport { User, Party } from '../../models/User';\nimport Button from './components/Button';\nimport { getHashParams } from './helpers/helpers';\nimport { UserProvider, useUser } from './contexts/UserContext';\n\ninterface AuthHashParams {\n  access_token: string;\n  token_type: string;\n}\n\n\nfunction App() {\n  const APP_URL = 'http://localhost:8080'\n  const LOGIN_URL = APP_URL + '/login';\n\n  const { user, updateUser, clearUser } = useUser();\n\n  console.log(user);\n\n  const socket = io(APP_URL);\n  socket.on('party-created', (party: Party) => {\n    console.log(party);\n  });\n\n\n  const checkLogIn = (): void => {\n    const savedUser = localStorage.getItem('user');\n    if (savedUser) {\n      updateUser(JSON.parse(savedUser));\n      return;\n    }\n\n    if (!window.location.hash) return;\n    login();\n  }\n\n  useEffect(checkLogIn, [])\n\n  const logout = (): void => {\n    clearUser();\n    localStorage.clear();\n  }\n\n  const login = (): void => {\n    let locationArgs: AuthHashParams = getHashParams(window.location.hash);\n    axios.defaults.headers.common['Authorization'] = 'Bearer ' + locationArgs.access_token;\n    axios.get(API_ENDPOINTS.ME).then((res: AxiosResponse<User>) => {\n      console.log(res.data);\n      const user = res.data;\n      updateUser(user)\n      localStorage.setItem('user', JSON.stringify(user));\n      // socket.emit('newconnection', user);\n    });\n  }\n\n  const createRoom = (): void => {\n    socket.emit('party-create', socket.id);\n  }\n\n\n\n  return (\n    <UserProvider>\n      <div className=\"App\">\n        <header className=\"App-header\">\n        </header>\n        <Switch>\n          <Route exact path='/'>\n            {user && user.id ?\n              <div>\n                <div>Hi, {user.id}!</div>\n                <Button name=\"Logout\" onClick={logout}></Button>\n                <Button name=\"Create new Room\" onClick={createRoom}></Button>\n              </div>\n              :\n              <a href={LOGIN_URL}>Login</a>\n            }\n          </Route>\n        </Switch>\n\n      </div>\n    </UserProvider>\n  );\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}