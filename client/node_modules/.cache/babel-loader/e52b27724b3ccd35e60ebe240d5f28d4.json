{"ast":null,"code":"import _slicedToArray from\"/Users/max/dev/listening-party/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{EventType}from'../common';import{useUser}from'../contexts/UserContext';import socket from'../socket';var PartyPage=function PartyPage(_ref){var _party$users;var match=_ref.match;var _useUser=useUser(),user=_useUser.user;var partyId=match.params.id;var _useState=useState(0),_useState2=_slicedToArray(_useState,2),numberOfUsers=_useState2[0],setNumberOfUsers=_useState2[1];var _useState3=useState(undefined),_useState4=_slicedToArray(_useState3,2),party=_useState4[0],setParty=_useState4[1];console.log(partyId);var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),usersInParty=_useState6[0],setUsersInParty=_useState6[1];useEffect(function(){var joinedPartyArgs={socketId:socket.id,partyId:partyId};var eventType=user?EventType.PARTY_JOINED_REQ:EventType.PARTY_JOINED_UNAUTHED_REQ;socket.emit(eventType,joinedPartyArgs);// init listeners\nsocket.on(EventType.PARTY_JOINED_RES,onPartyJoined);socket.on(EventType.PARTY_JOINED_UNAUTHED_RES,onPartyJoinedUnauthed);},[]);var onPartyJoined=function onPartyJoined(party){console.log('party state',party);setParty(party);};var onPartyJoinedUnauthed=function onPartyJoinedUnauthed(numberOfUsers){setNumberOfUsers(numberOfUsers);};return/*#__PURE__*/React.createElement(\"div\",null,user&&user.id?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",null,\"Hi, \",user.id,\"!\")):/*#__PURE__*/React.createElement(\"div\",null,\"This is a party of \",numberOfUsers,\", but you aint authed.\"),/*#__PURE__*/React.createElement(\"div\",null,party===null||party===void 0?void 0:(_party$users=party.users)===null||_party$users===void 0?void 0:_party$users.map(function(user){return user.display_name;})));};export default PartyPage;","map":{"version":3,"sources":["/Users/max/dev/listening-party/client/src/pages/Party.tsx"],"names":["React","useEffect","useState","EventType","useUser","socket","PartyPage","match","user","partyId","params","id","numberOfUsers","setNumberOfUsers","undefined","party","setParty","console","log","usersInParty","setUsersInParty","joinedPartyArgs","socketId","eventType","PARTY_JOINED_REQ","PARTY_JOINED_UNAUTHED_REQ","emit","on","PARTY_JOINED_RES","onPartyJoined","PARTY_JOINED_UNAUTHED_RES","onPartyJoinedUnauthed","users","map","display_name"],"mappings":"wHAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CAGA,OAASC,SAAT,KAAiC,WAAjC,CAMA,OAASC,OAAT,KAAwB,yBAAxB,CACA,MAAOC,CAAAA,MAAP,KAAmB,WAAnB,CAOA,GAAMC,CAAAA,SAA0B,CAAG,QAA7BA,CAAAA,SAA6B,MAAmC,qBAAhCC,CAAAA,KAAgC,MAAhCA,KAAgC,cACjDH,OAAO,EAD0C,CAC1DI,IAD0D,UAC1DA,IAD0D,CAElE,GAAMC,CAAAA,OAAO,CAAGF,KAAK,CAACG,MAAN,CAAaC,EAA7B,CAFkE,cAIxBT,QAAQ,CAAC,CAAD,CAJgB,wCAI3DU,aAJ2D,eAI5CC,gBAJ4C,8BAKxCX,QAAQ,CAAoBY,SAApB,CALgC,yCAK3DC,KAL2D,eAKpDC,QALoD,eAOlEC,OAAO,CAACC,GAAR,CAAYT,OAAZ,EAPkE,eAU1BP,QAAQ,CAAS,EAAT,CAVkB,yCAU3DiB,YAV2D,eAU7CC,eAV6C,eAYlEnB,SAAS,CAAC,UAAM,CACZ,GAAMoB,CAAAA,eAAe,CAAG,CAAEC,QAAQ,CAAEjB,MAAM,CAACM,EAAnB,CAAuBF,OAAO,CAAEA,OAAhC,CAAxB,CACA,GAAMc,CAAAA,SAAS,CAAGf,IAAI,CAAGL,SAAS,CAACqB,gBAAb,CAAgCrB,SAAS,CAACsB,yBAAhE,CACApB,MAAM,CAACqB,IAAP,CAAYH,SAAZ,CAAuBF,eAAvB,EAEA;AACAhB,MAAM,CAACsB,EAAP,CAAUxB,SAAS,CAACyB,gBAApB,CAAsCC,aAAtC,EACAxB,MAAM,CAACsB,EAAP,CAAUxB,SAAS,CAAC2B,yBAApB,CAA+CC,qBAA/C,EACH,CARQ,CAQN,EARM,CAAT,CAUA,GAAMF,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACd,KAAD,CAAkB,CACpCE,OAAO,CAACC,GAAR,CAAY,aAAZ,CAA2BH,KAA3B,EACAC,QAAQ,CAACD,KAAD,CAAR,CACH,CAHD,CAKA,GAAMgB,CAAAA,qBAAqB,CAAG,QAAxBA,CAAAA,qBAAwB,CAACnB,aAAD,CAA2B,CACrDC,gBAAgB,CAACD,aAAD,CAAhB,CACH,CAFD,CAIA,mBACI,+BACKJ,IAAI,EAAIA,IAAI,CAACG,EAAb,cACG,4CACI,sCAAUH,IAAI,CAACG,EAAf,KADJ,CADH,cAKG,qDAAyBC,aAAzB,0BANR,cAOI,+BAAMG,KAAN,SAAMA,KAAN,+BAAMA,KAAK,CAAEiB,KAAb,uCAAM,aAAcC,GAAd,CAAkB,SAAAzB,IAAI,QAAIA,CAAAA,IAAI,CAAC0B,YAAT,EAAtB,CAAN,CAPJ,CADJ,CAWH,CA1CD,CA4CA,cAAe5B,CAAAA,SAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport io from 'socket.io-client'\nimport { EventType, Party } from '../common';\nimport axios from 'axios';\nimport Button from '../components/Button';\nimport { getHashParams } from '../helpers/helpers';\nimport { withRouter, match } from 'react-router';\n\nimport { useUser } from '../contexts/UserContext';\nimport socket from '../socket';\nimport { User } from '../common';\n\ninterface Props {\n    match: any;\n}\n\nconst PartyPage: React.FC<Props> = ({ match }): React.ReactElement => {\n    const { user } = useUser();\n    const partyId = match.params.id;\n\n    const [numberOfUsers, setNumberOfUsers] = useState(0);\n    const [party, setParty] = useState<Party | undefined>(undefined);\n\n    console.log(partyId);\n\n\n    const [usersInParty, setUsersInParty] = useState<User[]>([]);\n\n    useEffect(() => {\n        const joinedPartyArgs = { socketId: socket.id, partyId: partyId };\n        const eventType = user ? EventType.PARTY_JOINED_REQ : EventType.PARTY_JOINED_UNAUTHED_REQ;\n        socket.emit(eventType, joinedPartyArgs)\n\n        // init listeners\n        socket.on(EventType.PARTY_JOINED_RES, onPartyJoined);\n        socket.on(EventType.PARTY_JOINED_UNAUTHED_RES, onPartyJoinedUnauthed);\n    }, [])\n\n    const onPartyJoined = (party: Party) => {\n        console.log('party state', party);\n        setParty(party);\n    }\n\n    const onPartyJoinedUnauthed = (numberOfUsers: number) => {\n        setNumberOfUsers(numberOfUsers);\n    }\n\n    return (\n        <div>\n            {user && user.id ?\n                <div>\n                    <div>Hi, {user.id}!</div>\n                </div>\n                :\n                <div>This is a party of {numberOfUsers}, but you aint authed.</div>}\n            <div>{party?.users?.map(user => user.display_name)}</div>\n        </div>);\n\n};\n\nexport default PartyPage;\n"]},"metadata":{},"sourceType":"module"}