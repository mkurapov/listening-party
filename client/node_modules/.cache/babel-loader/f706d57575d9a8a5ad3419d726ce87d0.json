{"ast":null,"code":"import _slicedToArray from\"/Users/max/dev/listening-party/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import{SocketEvent}from'../common';import{useHistory}from'react-router';import{useUser}from'../contexts/UserContext';import socket from'../socket';var PartyPage=function PartyPage(_ref){var _party$adminUser,_party$users;var match=_ref.match;var _useUser=useUser(),user=_useUser.user,isLoading=_useUser.isLoading;var _useState=useState(undefined),_useState2=_slicedToArray(_useState,2),party=_useState2[0],setParty=_useState2[1];var partyId=match.params.id;var history=useHistory();socket.on(SocketEvent.PARTY_JOINED_RES,function(party){console.log('USER JOINED PARTY',party);setParty(party);});socket.on(SocketEvent.USER_LEFT_PARTY_RES,function(party){console.log('USER LEFT PARTY',party);setParty(party);});socket.on(SocketEvent.PARTY_NOT_FOUND_RES,function(party){console.log('This party was not found... redirecting back');setTimeout(function(){history.push('/');},2000);});useEffect(function(){console.log('loaded party first time');// NEED TO CHECK IF PARTY EXISTS HERE \nreturn function(){socket.emit(SocketEvent.USER_LEFT_PARTY_REQ);};},[]);useEffect(function(){if(!user||isLoading){console.log('You are not authed');return;}console.log('Logged in as ',user.id);socket.emit(SocketEvent.PARTY_JOINED_REQ,{user:user,socketId:socket.id,partyId:partyId});},[user]);// const onPartyJoinedUnauthed = (numberOfUsers: number) => {\n//     console.log('PARTY JOINED BACK')\n//     setNumberOfUsers(numberOfUsers);\n// }\nreturn/*#__PURE__*/React.createElement(\"div\",null,user&&user.id&&party?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",null,\"A duper dope party\"),/*#__PURE__*/React.createElement(\"div\",null,\"Hi, \",user.id,\"!\"),/*#__PURE__*/React.createElement(\"div\",null,\"The party admin is: $\",(_party$adminUser=party.adminUser)===null||_party$adminUser===void 0?void 0:_party$adminUser.id),/*#__PURE__*/React.createElement(\"div\",null,\"Users in here: \",(_party$users=party.users)===null||_party$users===void 0?void 0:_party$users.map(function(user){return user.display_name;}).join(', '))):/*#__PURE__*/React.createElement(\"div\",null,\"This is a party, but you aint authed.\"));};export default PartyPage;","map":{"version":3,"sources":["/Users/max/dev/listening-party/client/src/pages/Party.tsx"],"names":["React","useEffect","useState","SocketEvent","useHistory","useUser","socket","PartyPage","match","user","isLoading","undefined","party","setParty","partyId","params","id","history","on","PARTY_JOINED_RES","console","log","USER_LEFT_PARTY_RES","PARTY_NOT_FOUND_RES","setTimeout","push","emit","USER_LEFT_PARTY_REQ","PARTY_JOINED_REQ","socketId","adminUser","users","map","display_name","join"],"mappings":"wHAAA,MAAOA,CAAAA,KAAP,EAAgBC,SAAhB,CAA2BC,QAA3B,KAA2C,OAA3C,CAGA,OAASC,WAAT,KAAmC,WAAnC,CAIA,OAA4BC,UAA5B,KAA8C,cAA9C,CAEA,OAASC,OAAT,KAAwB,yBAAxB,CACA,MAAOC,CAAAA,MAAP,KAAmB,WAAnB,CAOA,GAAMC,CAAAA,SAA0B,CAAG,QAA7BA,CAAAA,SAA6B,MAAmC,sCAAhCC,CAAAA,KAAgC,MAAhCA,KAAgC,cACtCH,OAAO,EAD+B,CAC1DI,IAD0D,UAC1DA,IAD0D,CACpDC,SADoD,UACpDA,SADoD,eAExCR,QAAQ,CAAoBS,SAApB,CAFgC,wCAE3DC,KAF2D,eAEpDC,QAFoD,eAGlE,GAAMC,CAAAA,OAAO,CAAGN,KAAK,CAACO,MAAN,CAAaC,EAA7B,CACA,GAAMC,CAAAA,OAAO,CAAGb,UAAU,EAA1B,CAGAE,MAAM,CAACY,EAAP,CAAUf,WAAW,CAACgB,gBAAtB,CAAwC,SAACP,KAAD,CAAkB,CACtDQ,OAAO,CAACC,GAAR,CAAY,mBAAZ,CAAiCT,KAAjC,EACAC,QAAQ,CAACD,KAAD,CAAR,CACH,CAHD,EAKAN,MAAM,CAACY,EAAP,CAAUf,WAAW,CAACmB,mBAAtB,CAA2C,SAACV,KAAD,CAAkB,CACzDQ,OAAO,CAACC,GAAR,CAAY,iBAAZ,CAA+BT,KAA/B,EACAC,QAAQ,CAACD,KAAD,CAAR,CACH,CAHD,EAKAN,MAAM,CAACY,EAAP,CAAUf,WAAW,CAACoB,mBAAtB,CAA2C,SAACX,KAAD,CAAkB,CACzDQ,OAAO,CAACC,GAAR,CAAY,8CAAZ,EACAG,UAAU,CAAC,UAAM,CACbP,OAAO,CAACQ,IAAR,CAAa,GAAb,EACH,CAFS,CAEP,IAFO,CAAV,CAGH,CALD,EAOAxB,SAAS,CAAC,UAAM,CACZmB,OAAO,CAACC,GAAR,CAAY,yBAAZ,EACA;AACA,MAAO,WAAM,CAAEf,MAAM,CAACoB,IAAP,CAAYvB,WAAW,CAACwB,mBAAxB,EAA8C,CAA7D,CACH,CAJQ,CAIN,EAJM,CAAT,CAOA1B,SAAS,CAAC,UAAM,CACZ,GAAI,CAACQ,IAAD,EAASC,SAAb,CAAwB,CACpBU,OAAO,CAACC,GAAR,CAAY,oBAAZ,EACA,OACH,CAEDD,OAAO,CAACC,GAAR,CAAY,eAAZ,CAA6BZ,IAAI,CAACO,EAAlC,EACAV,MAAM,CAACoB,IAAP,CAAYvB,WAAW,CAACyB,gBAAxB,CAA0C,CAAEnB,IAAI,CAAEA,IAAR,CAAcoB,QAAQ,CAAEvB,MAAM,CAACU,EAA/B,CAAmCF,OAAO,CAAEA,OAA5C,CAA1C,EACH,CARQ,CAQN,CAACL,IAAD,CARM,CAAT,CAUA;AACA;AACA;AACA;AAEA,mBACI,+BACKA,IAAI,EAAIA,IAAI,CAACO,EAAb,EAAmBJ,KAAnB,cACG,4CACI,mDADJ,cAEI,sCAAUH,IAAI,CAACO,EAAf,KAFJ,cAGI,yEAA2BJ,KAAK,CAACkB,SAAjC,2CAA2B,iBAAiBd,EAA5C,CAHJ,cAII,+DAAqBJ,KAAK,CAACmB,KAA3B,uCAAqB,aAAaC,GAAb,CAAiB,SAAAvB,IAAI,QAAIA,CAAAA,IAAI,CAACwB,YAAT,EAArB,EAA4CC,IAA5C,CAAiD,IAAjD,CAArB,CAJJ,CADH,cAQG,uEATR,CADJ,CAaH,CA3DD,CA6DA,cAAe3B,CAAAA,SAAf","sourcesContent":["import React, { useEffect, useState } from 'react';\nimport { useLocation } from 'react-router-dom';\nimport io from 'socket.io-client'\nimport { SocketEvent, Party } from '../common';\nimport axios from 'axios';\nimport Button from '../components/Button';\nimport { getHashParams } from '../helpers/helpers';\nimport { withRouter, match, useHistory } from 'react-router';\n\nimport { useUser } from '../contexts/UserContext';\nimport socket from '../socket';\nimport { User } from '../common';\n\ninterface Props {\n    match: any;\n}\n\nconst PartyPage: React.FC<Props> = ({ match }): React.ReactElement => {\n    const { user, isLoading } = useUser();\n    const [party, setParty] = useState<Party | undefined>(undefined);\n    const partyId = match.params.id;\n    const history = useHistory();\n\n\n    socket.on(SocketEvent.PARTY_JOINED_RES, (party: Party) => {\n        console.log('USER JOINED PARTY', party);\n        setParty(party);\n    });\n\n    socket.on(SocketEvent.USER_LEFT_PARTY_RES, (party: Party) => {\n        console.log('USER LEFT PARTY', party);\n        setParty(party);\n    });\n\n    socket.on(SocketEvent.PARTY_NOT_FOUND_RES, (party: Party) => {\n        console.log('This party was not found... redirecting back');\n        setTimeout(() => {\n            history.push('/');\n        }, 2000);\n    });\n\n    useEffect(() => {\n        console.log('loaded party first time')\n        // NEED TO CHECK IF PARTY EXISTS HERE \n        return () => { socket.emit(SocketEvent.USER_LEFT_PARTY_REQ) };\n    }, [])\n\n\n    useEffect(() => {\n        if (!user || isLoading) {\n            console.log('You are not authed');\n            return;\n        }\n\n        console.log('Logged in as ', user.id);\n        socket.emit(SocketEvent.PARTY_JOINED_REQ, { user: user, socketId: socket.id, partyId: partyId })\n    }, [user])\n\n    // const onPartyJoinedUnauthed = (numberOfUsers: number) => {\n    //     console.log('PARTY JOINED BACK')\n    //     setNumberOfUsers(numberOfUsers);\n    // }\n\n    return (\n        <div>\n            {user && user.id && party ?\n                <div>\n                    <h1>A duper dope party</h1>\n                    <div>Hi, {user.id}!</div>\n                    <div>The party admin is: ${party.adminUser?.id}</div>\n                    <div>Users in here: {party.users?.map(user => user.display_name).join(', ')}</div>\n                </div>\n                :\n                <div>This is a party, but you aint authed.</div>}\n        </div>);\n\n};\n\nexport default PartyPage;\n"]},"metadata":{},"sourceType":"module"}